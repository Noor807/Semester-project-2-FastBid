import{o as h}from"./logout-Bp4xtVrQ.js";import{a as m,b as u}from"./constants-D-ym1ySC.js";import{g}from"./higherBider-DIwdkbzu.js";import{t as p}from"./toastMsg-pxLBbmNp.js";async function y(n){const t=`${m}/${n}/bids?_listings=true`,o={"Content-Type":"application/json",Authorization:`Bearer ${localStorage.getItem("token")}`,"X-Noroff-API-Key":u};try{const e=await fetch(t,{method:"GET",headers:o});if(!e.ok)throw new Error(`Error fetching listings: ${e.statusText}`);return await e.json()}catch(e){throw console.error("Error:",e),e}}async function w(n){const t=document.getElementById("myBids");t.innerHTML="",n.forEach(r=>{const o=document.createElement("div");o.classList.add("flex","flex-col","sm:flex-row","justify-between","space-y-4","sm:space-y-0","p-4","bg-blue-100","border","border-gray-300","rounded-lg","shadow-lg");const e=document.createElement("div");e.classList.add("flex","flex-col","sm:flex-col","justify-center","items-center","sm:items-start","space-y-2","sm:space-y-0");const a=document.createElement("h3");a.textContent=r.listing.title,a.classList.add("font-semibold","text-xs");const s=document.createElement("img");s.src=r.listing.media[0]?.url||"",s.alt=r.listing.media[0]?.alt||"Image",s.classList.add("w-20","h-20","object-cover","rounded-lg","sm:mr-4"),e.appendChild(a),e.appendChild(s);const i=document.createElement("div");i.classList.add("flex","flex-row","items-center","sm:items-start","space-y-2");const c=document.createElement("p");c.textContent=`Bid: $${r.amount}`,c.classList.add("text-sm","font-semibold","text-blue-800"),i.appendChild(c),o.appendChild(e),o.appendChild(i),t.appendChild(o)})}async function E(){const n=JSON.parse(localStorage.getItem("adminUser"));try{const t=await y(n.name);if(!t)throw new Error("something went wrong fail to fetch");w(t.data)}catch{console.error("error")}}async function x(n){const t=`${m}/${n}/listings?_bids=true`,o={"Content-Type":"application/json",Authorization:`Bearer ${localStorage.getItem("token")}`,"X-Noroff-API-Key":u};try{const e=await fetch(t,{method:"GET",headers:o});if(!e.ok)throw new Error(`Error fetching listings: ${e.statusText}`);return await e.json()}catch(e){throw console.error("Error:",e),e}}async function b(n){const t=document.getElementById("auctionContainer");t.innerHTML="",n.forEach(r=>{const o=document.createElement("section");o.className="flex flex-col w-full bg-gray-300 border-2 border-gray-400 p-4 ";const e=document.createElement("h3");e.className="font-bold",e.textContent=r.title;const a=document.createElement("div");a.className="flex flex-col  sm:flex-row gap-2 relative w-full";const s=document.createElement("img");s.className="w-20 h-20",s.src=r.media[0]?.url||"",s.alt=r.media[0]?.alt||"Item Image";const{highestBid:i}=g(r),c=document.createElement("div");c.className="flex flex-col gap-2";const l=document.createElement("p");l.textContent=r.description;const f=document.createElement("p");f.className="font-semibold text-blue-900 ",f.textContent=`Price: $${i}`,c.appendChild(l),c.appendChild(f);const d=document.createElement("button");d.type="button",d.textContent="View auction",d.className=" static md:absolute  md:right-8 md:top-1/2 md:-translate-y-1/2 bg-blue-gray w-fit p-1 m-auto font-semibold  text-white border-2",d.addEventListener("click",()=>{window.location.href=`/post/index.html?singleList=${r.id}`}),a.appendChild(s),a.appendChild(c),a.appendChild(d),o.appendChild(e),o.appendChild(a),t.appendChild(o)})}async function C(){const n=JSON.parse(localStorage.getItem("adminUser"));try{const t=await x(n.name);if(!t)throw new Error("something went wrong fail to fetch");b(t.data)}catch{console.error("error")}}async function I(n){const t=`${m}/${n}/wins?_bids=true`,o={"Content-Type":"application/json",Authorization:`Bearer ${localStorage.getItem("token")}`,"X-Noroff-API-Key":u};try{const e=await fetch(t,{method:"GET",headers:o});if(!e.ok)throw new Error(`Error fetching listings: ${e.statusText}`);return await e.json()}catch(e){throw console.error("Error:",e),e}}async function v(n){const t=document.getElementById("winList");if(t.innerHTML="",n.length===0){t.className="w-full h-20 bg-red-500 text-white flex justify-center items-center",t.textContent="Sorry you havenâ€™t won anything yet";return}n.forEach(r=>{const o=document.createElement("div");o.classList.add("flex","flex-col","sm:flex-col","lg:flex-col","mb-8","border","rounded-lg","shadow-md","bg-teal-100","p-4","space-y-4","sm:space-y-0","sm:space-x-6","sm:items-center");const e=document.createElement("div");e.classList.add("flex","flex-col","sm:flex-col","sm:items-center","sm:space-x-4","w-full");const a=document.createElement("h3");a.classList.add("font-bold","text-gray-800"),a.innerText=r.title;const s=document.createElement("img");s.src=r.media[0]?.url||"",s.alt=r.media[0]?.alt||"Image",s.classList.add("w-32","h-32","sm:w-32","sm:h-32","rounded-lg","object-cover","mb-4","sm:mb-0"),e.appendChild(a),e.appendChild(s);const{highestBid:i}=g(r),c=document.createElement("div");c.classList.add("text-gray-700","font-medium","sm:ml-auto","mt-4","sm:mt-0");const l=document.createElement("p");l.classList.add("text-sm","font-semibold","text-blue-700"),l.textContent=`Won for: $${i}`,c.appendChild(l),o.appendChild(e),o.appendChild(c),t.appendChild(o)})}async function L(){const n=JSON.parse(localStorage.getItem("adminUser"));try{const t=await I(n.name);if(!t)throw new Error("something went wrong fail to fetch");v(t.data)}catch{console.error("error")}}async function B(n,t,r){const o=`${m}/${n}`,e={avatar:{url:t,alt:"User avatar"}};try{const a=await fetch(o,{method:"PUT",headers:{"Content-Type":"application/json",Authorization:`Bearer ${r}`,"X-Noroff-API-Key":u},body:JSON.stringify(e)});if(!a.ok)throw new Error(`Error: ${a.statusText}`);const s=await a.json(),i=s.data;return localStorage.setItem("adminUser",JSON.stringify(i)),s}catch(a){return console.error("Error updating profile:",a),alert("There was an error updating your profile."),null}}async function $(n){n.preventDefault();const t=document.getElementById("profileAvatar").value,r=JSON.parse(localStorage.getItem("adminUser")),o=localStorage.getItem("token");if(!t){p("Please fill out required feild.","alert");return}B(r.name,t,o).then(e=>{e&&p("Profile updated successfully!","success")})}async function N(){const n=JSON.parse(localStorage.getItem("adminUser")),t=localStorage.getItem("credit");document.getElementById("avatar").src=n.avatar.url,document.getElementById("profileName").textContent=n.name,document.getElementById("wallet").textContent=`${t}$`}L();C();E();document.getElementById("profileUpdate").addEventListener("submit",$);N();document.getElementById("logout-Btn").addEventListener("click",h);const k=document.getElementById("hamburger-btn"),S=document.getElementById("navbar-links");k.addEventListener("click",()=>{S.classList.toggle("hidden")});
