import{A as N}from"./constants-D-ym1ySC.js";import{u as D}from"./loginAdmin-CrNTEl2x.js";import{g as A}from"./higherBider-DIwdkbzu.js";import{t as w}from"./toastMsg-pxLBbmNp.js";import"./logout-Bp4xtVrQ.js";function S(t,s,e,o){const r=`${N}`,n=`limit=${t}&page=${s}&_seller=true&_bids=true`;return e?`${r}/search?q=${encodeURIComponent(e)}&${n}`:o?`${r}?_tag=${encodeURIComponent(o)}&${n}`:`${r}?${n}`}async function h(t=12,s=1,e=null,o=null,r=!1){const n=S(t,s,e,o);try{const a=await fetch(n,{method:"GET",headers:{"Content-Type":"application/json"}});if(!a.ok){const i=`Failed to fetch auction listings. Status: ${a.status}`;throw console.error(i),new Error(i)}return await a.json()}catch(a){throw console.error("Error fetching auction listings:",a),a}}function B(t){const s=document.getElementById("auctionContainer");s.innerHTML="",s.classList.add("grid","gap-6","sm:grid-cols-1","md:grid-cols-2","lg:grid-cols-2","xl:grid-cols-3"),t.forEach(e=>{const r=P(e.endsAt)==="Listing ended",n=document.createElement("div");if(n.className="listing-card cursor-pointer p-4 border-2 border-black-600 relative rounded-lg shadow-md transition-transform transform hover:scale-105",n.addEventListener("click",()=>{window.location.href=`/post/index.html?singleList=${e.id}`}),r){n.classList.add("relative");const I=document.createElement("div");I.className="absolute inset-0 flex justify-center items-center bg-light-blue opacity-80 text-black p-4 text-xs font-semibold",I.textContent="Auction of list is ended",n.appendChild(I)}const a=document.createElement("div");a.className="image-wrapper mb-4";const c=document.createElement("img");c.src=e.media[0]?.url||"",c.alt=e.media[0]?.alt||" Image",c.className="w-full h-48 object-cover rounded-md",a.appendChild(c),n.appendChild(a);const i=document.createElement("div"),g=document.createElement("div");g.className="mb-4 border-b border-gray-300";const E=document.createElement("h2");E.textContent=e.title,E.className="font-bold text-gray-900",g.appendChild(E);const b=document.createElement("h3");b.textContent=e.tags[0]||"Unknown Category",b.className="text-gray-600",g.appendChild(b),i.appendChild(g);const{highestBid:$}=A(e),u=document.createElement("div");u.className="flex justify-between items-center";const C=document.createElement("p");C.textContent=`Current Price: $${$||"0.00"}`,C.className="font-semibold text-gray-900",u.appendChild(C);const l=document.createElement("a");l.addEventListener("click",()=>{localStorage.setItem("trigger",!0)}),l.className="cursor-pointer font-semibold bg-blue-gray  text-white hover:bg-white hover:text-blue-gray px-3 py-1 rounded-md border border-orange-500 focus:outline-none focus:ring-2 focus:ring-blue-500",l.href=`/post/index.html?singleList=${e.id}`,l.textContent=`Bids: ${e._count?.bids||0}`,u.appendChild(l),i.appendChild(u);const p=document.createElement("div");p.className="flex justify-between items-end mt-4";const m=document.createElement("div");m.className="flex flex-col";const y=document.createElement("p");y.textContent=`Created: ${new Date(e.created).toLocaleDateString()}`,y.className="text-gray-600",m.appendChild(y);const v=document.createElement("p");v.textContent=`Updated: ${new Date(e.updated).toLocaleDateString()}`,v.className="text-gray-600",m.appendChild(v);const x=document.createElement("p");x.textContent=`Ends At: ${new Date(e.endsAt).toLocaleDateString()}`,x.className="text-gray-600",m.appendChild(x),p.appendChild(m);const L=document.createElement("p");L.textContent=e.freeShipping?"Free Shipping":"Shipping Cost",L.className="text-black-600 font-semibold",p.appendChild(L),i.appendChild(p),n.appendChild(i),s.appendChild(n)})}function P(t){return new Date(t)<=new Date?"Listing ended":""}let f=1;document.getElementById("categories").addEventListener("change",()=>{document.getElementById("search-input").value="",d(1)});document.getElementById("search-input").addEventListener("input",()=>{d(1)});const d=async(t=1)=>{const s=document.getElementById("search-input").value.trim(),e=document.getElementById("categories").value;try{let o;s?o=await h(12,t,s,null,!0):e?o=await h(12,t,null,e,!1):o=await h(12,t,null,null,!1);const{data:r,meta:n}=o;document.getElementById("auctionContainer").innerHTML="",B(r),k(n,t),f=t}catch(o){console.error("Error fetching data:",o)}},k=(t,s)=>{const e=document.getElementById("left"),o=document.getElementById("right");e.disabled=s===1||t.isFirstPage,o.disabled=t.isLastPage},U=()=>{f>1&&d(f-1)},j=()=>{d(f+1)};document.getElementById("left").addEventListener("click",U);document.getElementById("right").addEventListener("click",j);window.onload=()=>{d(1)};D();d();const T=document.getElementById("hamburger-btn"),_=document.getElementById("navbar-links");T.addEventListener("click",()=>{_.classList.toggle("hidden")});async function F(){try{const t=await h();B(t.data)}catch(t){console.error("Error fetching and rendering auctions:",t)}}F();sessionStorage.getItem("loggedIn")==="true"&&(w("Welcome to FastBid","success"),sessionStorage.removeItem("loggedIn"));sessionStorage.getItem("deleteList")==="true"&&(w("List has be deleted","success"),sessionStorage.removeItem("deleteList"));localStorage.getItem("logout")==="true"&&(w("you loggged out","success"),localStorage.removeItem("logout"));
