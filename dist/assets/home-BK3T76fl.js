import{A as N}from"./constants-BFXYqvjv.js";import{u as A}from"./loginAdmin-ii201TkH.js";import{g as D}from"./higherBider-DIwdkbzu.js";import{a as S}from"./authGuard-C2GFzsuy.js";import{s as P}from"./hamburgerMenu-Mj8nOhEq.js";import{t as I}from"./toastMsg-pxLBbmNp.js";function k(t,s,e,o){const r=`${N}`,n=`limit=${t}&page=${s}&_seller=true&_bids=true`;return e?`${r}/search?q=${encodeURIComponent(e)}&${n}`:o?`${r}?_tag=${encodeURIComponent(o)}&${n}`:`${r}?${n}`}async function h(t=12,s=1,e=null,o=null,r=!1){const n=k(t,s,e,o);try{const a=await fetch(n,{method:"GET",headers:{"Content-Type":"application/json"}});if(!a.ok){const i=`Failed to fetch auction listings. Status: ${a.status}`;throw console.error(i),new Error(i)}return await a.json()}catch(a){throw console.error("Error fetching auction listings:",a),a}}function $(t){const s=document.getElementById("auctionContainer");s.innerHTML="",s.classList.add("grid","gap-6","sm:grid-cols-1","md:grid-cols-2","lg:grid-cols-2","xl:grid-cols-3"),t.forEach(e=>{const r=U(e.endsAt)==="Listing ended",n=document.createElement("div");if(n.className="listing-card cursor-pointer p-4 border-2 border-black-600 relative rounded-lg shadow-md transition-transform transform hover:scale-105",n.addEventListener("click",()=>{window.location.href=`/post/index.html?singleList=${e.id}`}),r){n.classList.add("relative");const w=document.createElement("div");w.className="absolute inset-0 flex justify-center items-center bg-light-blue opacity-80 text-black p-4 text-xs font-semibold",w.textContent="Auction of list is ended",n.appendChild(w)}const a=document.createElement("div");a.className="image-wrapper mb-4";const c=document.createElement("img");c.src=e.media[0]?.url||"",c.alt=e.media[0]?.alt||"No description",c.className="w-full h-48 object-cover rounded-md",a.appendChild(c),n.appendChild(a);const i=document.createElement("div"),u=document.createElement("div");u.className="mb-4 border-b border-gray-300";const E=document.createElement("h2");E.textContent=e.title||"Untitled Auction",E.className="font-bold text-gray-900",u.appendChild(E);const C=document.createElement("h3");C.textContent=e.tags[0]||"Unknown Category",C.className="text-gray-600",u.appendChild(C),i.appendChild(u);const{highestBid:B}=D(e),g=document.createElement("div");g.className="flex justify-between items-center";const b=document.createElement("p");b.textContent=`Current Price: $${B||"0.00"}`,b.className="font-semibold text-gray-900",g.appendChild(b);const l=document.createElement("a");l.addEventListener("click",()=>{localStorage.setItem("trigger",!0)}),l.className="cursor-pointer font-semibold bg-blue-gray text-white hover:bg-white hover:text-blue-gray px-3 py-1 rounded-md border border-orange-500 focus:outline-none focus:ring-2 focus:ring-blue-500",l.href=`/post/index.html?singleList=${e.id}`,l.textContent=`Bids: ${e._count?.bids||0}`,g.appendChild(l),i.appendChild(g);const p=document.createElement("div");p.className="flex justify-between items-end mt-4";const m=document.createElement("div");m.className="flex flex-col";const y=document.createElement("p");y.textContent=`Created: ${new Date(e.created).toLocaleDateString()}`,y.className="text-gray-600",m.appendChild(y);const v=document.createElement("p");v.textContent=`Updated: ${new Date(e.updated).toLocaleDateString()}`,v.className="text-gray-600",m.appendChild(v);const x=document.createElement("p");x.textContent=`Ends At: ${new Date(e.endsAt).toLocaleDateString()}`,x.className="text-gray-600",m.appendChild(x),p.appendChild(m);const L=document.createElement("p");L.textContent=e.freeShipping?"Free Shipping":"Shipping Cost",L.className="text-black-600 font-semibold",p.appendChild(L),i.appendChild(p),n.appendChild(i),s.appendChild(n)})}function U(t){return new Date(t)<=new Date?"Listing ended":""}let f=1;document.getElementById("categories").addEventListener("change",()=>{document.getElementById("search-input").value="",d(1)});document.getElementById("search-input").addEventListener("input",()=>{d(1)});const d=async(t=1)=>{const s=document.getElementById("search-input").value.trim(),e=document.getElementById("categories").value;try{let o;s?o=await h(12,t,s,null,!0):e?o=await h(12,t,null,e,!1):o=await h(12,t,null,null,!1);const{data:r,meta:n}=o;document.getElementById("auctionContainer").innerHTML="",$(r),j(n,t),f=t}catch(o){console.error("Error fetching data:",o)}},j=(t,s)=>{const e=document.getElementById("left"),o=document.getElementById("right");e.disabled=s===1||t.isFirstPage,o.disabled=t.isLastPage},T=()=>{f>1&&d(f-1)},_=()=>{d(f+1)};document.getElementById("left").addEventListener("click",T);document.getElementById("right").addEventListener("click",_);window.onload=()=>{d(1)};P();A();S();d();async function F(){try{const t=await h();$(t.data)}catch(t){console.error("Error fetching and rendering auctions:",t)}}F();sessionStorage.getItem("loggedIn")==="true"&&(I("Welcome to FastBid","success"),sessionStorage.removeItem("loggedIn"));sessionStorage.getItem("deleteList")==="true"&&(I("List has be deleted","success"),sessionStorage.removeItem("deleteList"));localStorage.getItem("logout")==="true"&&(I("you loggged out","success"),localStorage.removeItem("logout"));
