import{f as u}from"./singleListRead-Cx7jcxUc.js";import{p as d}from"./authUtils-BlpDD4MX.js";import{A as g}from"./constants-BFXYqvjv.js";import{t as c}from"./toastMsg-pxLBbmNp.js";import{a as f}from"./authGuard-C2GFzsuy.js";import{s as p,o as h}from"./hamburgerMenu-Mj8nOhEq.js";async function w(t,o){try{const e=d(),r=await fetch(`${g}/${t}`,{method:"PUT",headers:e,body:JSON.stringify(o)});if(!r.ok){const n=(await r.json()).message||"Failed to update auction listing.";throw new Error(n)}const i=await r.json();if(!i||!i.data)throw new Error("Invalid response data");return i.data}catch(e){throw console.error("Error editing auction listing:",e.message||e),e}}async function v(t,o){t.preventDefault();const e=t.target.title.value.trim(),r=t.target.description.value.trim(),i=t.target.mediaUrl.value.trim(),s=t.target.mediaAlt.value.trim(),n=t.target.tags.value?t.target.tags.value.split(",").map(a=>a.trim()):[];if(!e&&!r&&!i&&!s&&n.length===0){c("At least one of Title, Description, or Media is required.");return}const m=localStorage.getItem("token");if(!m){c("You must be logged in to edit an auction.");return}const l={title:e,description:r,tags:n,media:i?[{url:i,alt:s}]:null};try{const a=await w(o,l,m);sessionStorage.setItem("updatedSuccess","true"),window.location.href=`/post/index.html?singleList=${o}`}catch(a){console.error("Error:",a),c("Failed to update auction listing: "+a.message)}}function A(t){if(!document.getElementById("edit-auction-form")){console.error("Form not found!");return}document.forms.editForm.title.value=t.title,document.forms.editForm.description.value=t.description,document.forms.editForm.tags.value=t.tags?t.tags.join(", "):"",document.forms.editForm.mediaUrl.value=t.media?t.media[0].url:"",document.forms.editForm.mediaAlt.value=t.media?t.media[0].alt:""}d();p();f();async function E(){try{const o=new URLSearchParams(window.location.search).get("post");if(!o)throw new Error("Auction ID not provided in the URL.");const e=await u(o),r=document.getElementById("edit-auction-form");if(e&&e.data)A(e.data);else throw new Error("Failed to fetch auction data.");r?r.addEventListener("submit",i=>v(i,o)):console.error("Edit form not found.")}catch(t){console.error("Error initializing the page:",t.message||t)}}E();document.getElementById("logout-Btn").addEventListener("click",h);
